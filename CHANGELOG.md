# 更新日志

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/lang/zh-CN/).

## [v1.0.7] - 2026-02-26

### 🐛 问题修复 (Bug Fixes)
*   **马赛克覆盖问题**
    > 修复马赛克工具会覆盖其他标注的问题，新增独立的马赛克层画布。

*   **标注溢出选区**
    > 修复标注工具可在选区外绘制的问题，坐标限制改为选区边界。

*   **计数器重置**
    > 修复右键取消步骤序号工具时计数器未重置的问题。

*   **工具栏状态**
    > 修复右键取消工具时工具栏按钮选中状态未更新的问题。

### ✨ 新特性 (Features)
*   **步骤序号标注**
    > 新增步骤序号标注工具，点击放置递增序号 (1, 2, 3...)，右键取消时计数器重置。

## [v1.0.6] - 2026-02-26

### 🐛 问题修复 (Bug Fixes)
*   **高DPI截屏不全**
    > 修复高DPI屏幕下截图区域不完整问题，使用物理像素转换。

*   **保存截图标注偏移**
    > 修复保存时标注错位问题，使用TranslateTransform反向平移+VisualBrush绝对视图区约束。

*   **图片+路径模式路径格式化**
    > 修复剪贴板模式为ImageAndPath时路径未格式化问题。

*   **锚点拖拽幽灵跳跃**
    > 修复使用dx/dy累加导致拖拽不稳定问题，改用绝对坐标计算。

*   **锚点拖拽光标错乱**
    > 添加光标翻转逻辑，拖拽越过中心时自动切换光标方向。

*   **CroppedBitmap越界**
    > 添加Math.Min边界防护，防止浮点数进位导致越界异常。

### 🚀 优化 (Optimizations)
*   RenderTargetBitmap尺寸改为选区大小，直接输出无需二次裁剪。
*   锚点拖拽最小尺寸限制改为1像素，消除抖动。

## [v1.0.5] - 2026-02-25

### ✨ 新特性 (Features)
*   **自定义文件名模板**
    > 支持 {yyyy}{MM}{dd}{HHmmss}{GUID} 占位符，可自定义截图文件名格式。

*   **马赛克工具**
    > 新增自由涂抹马赛克功能，使用像素化效果遮挡敏感信息。

*   **选区二次微调**
    > 选区完成后可通过8个锚点调整选区大小，支持反向拖拽翻转。

### 🐛 问题修复 (Bug Fixes)
*   修复 MainWindow 与 CaptureWindow 构造函数参数不匹配问题。
*   修复剪贴板模式和路径格式配置未生效问题。
*   修复标注溢出高亮区问题（调整XAML渲染层级）。
*   修复马赛克只能画线问题，改为Polyline自由轨迹。
*   修复锚点反向拖拽崩溃问题，实现智能翻转效果。
*   修复锚点拖拽时未收起属性栏问题。
*   修复马赛克画笔不可见问题（添加Viewbox/Viewport）。
*   修复设置界面脏状态泄漏问题。

### 🚀 优化 (Optimizations)
*   AnnotationCanvas保持全屏+Clip裁剪，避免标注位移。
*   添加DPI缩放计算，适配高DPI屏幕。
*   马赛克底图预渲染，优化涂抹性能。

## [v1.0.4] - 2026-02-25

### ✨ 新特性 (Features)
*   剪贴板模式选项：支持"仅路径"、"仅图片"、"图片+路径"三种模式
*   路径格式支持：纯文本、Markdown、HTML 三种格式
*   右键快捷取消：四级取消（取消绘制中 → 取消工具 → 取消选区 → 退出截图）

### 🐛 问题修复 (Bug Fixes)
*   修复选区取消时未清空画布导致的幽灵标注
*   修复取消工具时未关闭气泡面板
*   修复选区锁定后需多次右键才能退出的问题
*   修复保存失败时未尝试复制图片的问题
*   修复右键取消时未正确检测正在绘制的标注

## [v1.0.3] - 2026-02-25

### 🐛 问题修复 (Bug Fixes)
*   修复托盘模式下主窗口"幽灵窗口"显示问题
*   修复高 DPI 屏幕下截图模糊/被裁切的问题
*   修复文字工具输入时光标被截图的问题
*   修复空白文字框污染撤销栈导致需连点撤销的问题

### 🚀 优化 (Optimizations)
*   优化文字工具支持连续标注，行为与矩形/箭头一致

## [v1.0.2] - 2026-02-24

### ✨ 新特性 (Features)
*   新增气泡属性栏：选中矩形/箭头工具时弹出二级菜单
*   新增颜色选择：蓝色、红色、黑色三种颜色
*   新增线条粗细：细(1px)、中(2px)、粗(4px)三种粗细
*   新增每个工具独立的属性设置：矩形和箭头的颜色/粗细分开存储

### 🐛 问题修复 (Bug Fixes)
*   修复工具栏位置边界计算问题
*   修复切换工具时属性栏不显示的问题
*   修复颜色图标显示空白的问题

### 🚀 优化 (Optimizations)
*   优化属性栏UI设计，采用圆点图标表示粗细
*   优化属性栏对齐到选中工具

## [v1.0.1] - 2026-02-24

### ✨ 新特性 (Features)
*   新增框选标注功能：支持矩形、箭头、文字三种标注工具
*   新增浮动工具栏：选区完成后显示工具栏，支持撤销操作
*   新增挖孔效果：选区高亮显示，外部半透明遮罩

### 🐛 问题修复 (Bug Fixes)
*   修复截图窗口无法多次触发的问题
*   修复热键回调导致的跨线程异常
*   修复选区白色遮罩显示异常问题
*   修复标注工具无法点击的问题
*   修复标注溢出选区边界的问题
*   修复工具切换后事件未清除的问题
*   修复保存图片包含蓝色边框的问题

### 🚀 优化 (Optimizations)
*   重构截图保存逻辑，使用背景图直接裁剪
*   优化工具栏UI设计，采用蓝色主题风格
*   添加标注渲染到图片功能

## [v1.0.0] - 2026-02-22

### ✨ 新特性 (Features)
*   **快捷键截图**
    > 全局热键触发截图，默认 `Ctrl+Shift+A`，支持自定义修改。

*   **屏幕框选**
    > 蓝色框线选区 UI，实时显示像素尺寸。

*   **自动保存与路径复制**
    > 截图后自动保存到 Pictures\PathSnip 目录，路径自动复制到剪贴板，终端中直接 Ctrl+V 粘贴。

*   **托盘运行**
    > 最小化到系统托盘，后台常驻，支持托盘菜单操作。

*   **设置窗口**
    > 支持自定义快捷键、保存目录、开机自启、通知开关。

*   **GitHub Actions CI/CD**
    > 每次 push 自动构建验证。

### 🐛 问题修复 (Bug Fixes)
*   **蓝色蒙版问题**: 修复截图时选区窗口被截入的问题，现在截图清晰无蒙版。

### 🚀 优化 (Optimizations)
*   **轻量体积**: 编译产物 < 1MB，零外部依赖（仅依赖 .NET Framework 4.8 系统预装）。
